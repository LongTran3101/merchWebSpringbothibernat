
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">
<link rel="shortcut icon" type="image/x-icon" href="https://lh3.googleusercontent.com/fife/AAWUweVZg3sMC6axFZRXBvxTkrmlJ2zcZW0SMBRIZUpjd83Nqxh_67uKKpC3wO0Fjti6TnCc6ykMq3eZP2UlWn7Q8JjDE_bDm4_iP91Va90REd3Tc3v6OPt7ocbVeWxL7UeQip4gI7J60jvfhAmCpFw3JMEUHXFcSDBQcYDISxa_A2CeJ5bjDQZX04VibP-P6Mv1jzjhbpxDvgd4nu13Xw3BvA5PUPfDBWhLl0Pae_hToik4PpwtU5bTgoP9X6foF28YPZ-gr1SwZaLTJbv-DUkwBY1zYQDm78LgcHgUb58OMeJAKFxsqReCVhxzyqGctBgctjYxbkmyA04QKSxn18Ou_bYixc7qfrMvmO3v3kQvwbY-RvDaN2N4KVX2fcvq20WO65HYvNu2oMlpFBD_4hYkbuD1ORSffeJ1showhKMMCq6om9QdZSViNe_rRBgYI_Y4FeHjLG4nX_MHk_Xqlt5TcTMwtjxaoe0C33MGiFD8klzjiehyidsAMF_SXLY8VXNjhhEmWXFgRL56-krhtRQxP62G_c8XRqsk3kg0HKNaN9lAlJwurDVksJz_Sd7DUtBjY9ZM83lALAJXUHnRhU38cCUU8zLFwO9bePt0rzM-zbPpT-Epc-iQ8KxlrttRnfnDraGgOzY8TTJt8B_uZjeuoIR7WXmVgQwBstLoH5Ke1JfhyJQLmJgFYRPIpFzwahMdm7O0xvmPE6EyrdqlssYSdWB2jCsgEURT8zSWDesLLMq7ow-EN8jw9PHk3YGolS4rX3VXc6pRXf8-N4GImjvbJiXeVpOIvVAS0M-DxKrAlzAxKxqcGOwu8wrBFHCLX_YdzMEd7h-js1lyA5WWhUf_zP0IRwP4pNFoDZFrBqHIImsPEtBcE6gPhaUPBvS-sNLqvhv7qkY6ClbC5npcpIG_5peyX-GzWvP_xtZJwUClvY2xJHJ0FoB-X9AQ_AwnluZdTtALFltl=w1920-h937" />
<title>Merch Manager By Long Tran</title>
<script src="https://code.jquery.com/jquery-3.5.0.js"></script>
<link rel="canonical"
	href="https://getbootstrap.com/docs/4.0/examples/navbars/">

<!-- Bootstrap core CSS -->
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
	integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
	crossorigin="anonymous">
	<link href="https://cdn.jsdelivr.net/npm/tom-select@2.0.1/dist/css/tom-select.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.11.5/datatables.min.css"/>
<!-- Custom styles for this template -->
<style>
.error {
	background-color: yellow;
}

.success {
	background: #28a745;
}
table.dataTable th {
	font-size: 0.7em;
}

table.dataTable td {
	font-size: 0.7em;
}

</style>
</head>

<body>



	<nav class="navbar navbar-expand-lg navbar-light"
		style="background-color: #e3f2fd;">
		<a class="navbar-brand" href="#">Navbar</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse"
			data-target="#navbarColor03" aria-controls="navbarColor03"
			aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="navbarColor03">
			<ul class="navbar-nav mr-auto">
				<li class="nav-item active"><a class="nav-link"
					th:href="@{/user/allAcc}">All Account <span class="sr-only">(current)</span></a>
				</li>
				<li class="nav-item"><a class="nav-link"
					th:href="@{/user/checkSale}">Thống kê</a></li>
				<li class="nav-item"><a class="nav-link"
					th:href="@{/user/imageupload}">Quan Ly upload</a></li>
				<li class="nav-item"><a class="nav-link"
					th:href="@{/user/upload}">Upload</a></li>
				<li class="nav-item"><a class="nav-link"
					th:href="@{/admin/alluser}">Quản lý người dùng</a></li>
				<li class="nav-item"><a class="nav-link" href="#">About</a></li>
			</ul>
			<form class="form-inline">
				<input class="form-control mr-sm-2" type="search"
					placeholder="Search" aria-label="Search"> <a href="#"
					th:href="@{/logout}">Log Out</a>
			</form>
		</div>
	</nav>



	<div class="row" style="padding-left: 15px;">


		<div class="col-sm-2">
			<section>
				<h3>
					<small>Quản lý account</small>
				</h3>

			</section>
		</div>


	</div>

	<div class="row" style="padding-left: 15px;">
		<form th:action="@{/user/product}" style="width: 100%;">
			<div class="row">
				
				<div class="form-group col-md-4">
					<label class="col-md-6" for="inputEmail4">DATE SEARCH</label> 
					<input
						required="required" type="date" id="tu"
						th:value="${daySeach!=null ? daySeach:''}" name="daySearch">
					
					
					
				</div>
				<label class="col-md-1" for="inputEmail4">STATUS</label>
				<div class="form-group col-md-2">
					<select name="status" style="width: 100%">
						<option value="">ALL</option>
						<option value="0" th:selected="${daySeach!=null && status=='0'}">
							New</option>
						<option value="1" th:selected="${daySeach!=null && status=='1'}">
							Uploading</option>
						<option value="2" th:selected="${daySeach!=null && status=='2'}">
							Success</option>
						<option value="5" th:selected="${daySeach!=null && status=='5'}">
							Error</option>
					</select>
				</div>
				<label class="col-md-1" for="inputEmail4">ACC</label>
				<div class="form-group col-md-3">
				<select  class=" form-control ccySearch select2" style="    margin-top: -13px;"
								tabindex="1" name="idAccountSearch" data-class="">
								<option value="">Tat ca</option>
								<option th:each="item:${lstacc}" th:selected="${daySeach!=null && idAccountSearch==item.id}" th:text="${item.name} "
									th:value="${item.id}"></option>
							</select>
					 
				</div>

			</div>
			
			<div class="row">
				<div class="col-md-3 "></div>
				<div class="col-md-2 ">

					<button type="submit" class="btn btn-primary col-md-12">Tìm
						kiếm</button>

				</div>
				<div class="col-md-2 ">

					<button type="button" onclick="upload()"
						class="btn btn-primary col-md-12">Delete product</button>
				</div>
				
			</div>




		</form>



	</div>
	<div class="form-control">

		<form th:action="@{/user/deleteproduct}" method="post" id="formTable"
			style="width: 100%;">
			<div class="card-body table-responsive p-0">
				<table class="table table-hover" id="tableSale">
					<thead>
						<tr>
							<th><input type="checkbox" class="checkAll"></th>
							<th>STT</th>
							<th>Account</th>
							<th>IMG</th>
							<th>Asin</th>
							<th>Title</th>
							<th>Brand</th>
							<th>Sold</th>
							<th>royaltie</th>
							<th>mkt</th>
							<th>Create date</th>
							<th>Time update</th>
							<th>typeProduct</th>
							<th>price</th>
							<th>Status</th>

							
						</tr>
					</thead>
					<tbody>
						<th:block th:if="${lst != null}">
							<tr data-toggle="tooltip" th:each="item, k : ${lst}">
								<td><input type="checkbox" th:value="${item.id}" class="checkItem"
									name="checkItem"></td>
								<td th:text="${k.index + 1}" class="text-left"
									style="width: 5%;">1</td>
								<td th:text="${item.accName}" class="text-left nameAcc"></td>
								<td>
									<img th:attr="src=${item.base64}" style="border: white;    background: white;widows: 200px; height: 250px;" class="btn btn-primary  EditImage"></button>
								</td>
								<td th:text="${item.asin}" class="text-left nameAcc">
								<td th:text="${item.title}" class="text-left nameAcc">

								</td>
								<td th:text="${item.brand}" class="text-left nameAcc">
								<td th:text="${item.sold}" class="text-left nameAcc">
								<td th:text="${item.royaltie}" class="text-left nameAcc">

								</td>
								<td th:text="${item.mkt}" class="text-left nameAcc">
								<td th:text="${#dates.format(item.createDate, 'dd-MM-yyyy')}"></td>
								<td th:text="${#dates.format(item.dayUpdate, 'dd-MM-yyyy')}"></td>
								<td th:text="${item.typeProduct}" class="text-left nameAcc">
								<td th:text="${item.price}" class="text-left nameAcc">
								<td th:text="${item.status}" class="text-left nameAcc">

								
									
								

							</tr>
						</th:block>
					</tbody>
				</table>
			</div>
		</form>

	</div>

 
	<div class="modal fade" id="modal-default" tabindex="-1" style="display: none;overflow:hidden;"
		aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content" style="margin-left: -40px; width: 750px;">
				<div class="modal-header">
					<h4 class="modal-title">Edit</h4>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">×</span>
					</button>
				</div>
				<div class="modal-body">
					<form class="form-horizontal" role="form" id="fromAdd">
						<div class="row">
							<input type="hidden" name="idImage" id="idImage">
							
							<label class="col-md-2" >ACC
								MERCH </label>
							<div class="col-md-10" id="#select">
								<select required="required" class=" form-control ccy " style="width: 100%;"
									tabindex="1" name="idAccount" data-class="">
									<option th:each="item:${lstacc}" th:text="${item.name} "
										th:value="${item.id}"></option>
								</select>
							</div>

							<label class="col-md-2">Title</label>
							<div class="col-md-10">
								<textarea class="titleEdit" style="width: 100%;" rows="" name="title"
								cols=""></textarea>
							</div>
							<label class="col-md-2">Brand</label>
							<div class="col-md-10">
								<textarea class="brandEdit" style="width: 100%;" name="brand" rows=""
								cols=""></textarea>
							</div>
							<label class="col-md-2">Bullet 1</label>
							<div class="col-md-10">
								<textarea style="width: 100%; height: 150px;" class="bullet1Edit"
								name="des1" rows="" cols=""></textarea>
							</div>
							<label class="col-md-2">Bullet 1</label>
							<div class="col-md-10">
								<textarea style="width: 100%; height: 150px;" class="bullet2Edit"
								name="des2" rows="" cols=""></textarea>
							</div>
						</div>
					</form>

				</div>
				<div class="modal-footer justify-content-between">
					<button type="button" class="btn btn-default closetModal"
						data-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary saveAccount">Save
						changes</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>

	<div class="modal fade" id="modal-UpdateAll" tabindex="-1" style="display: none;overflow:hidden;"
		aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content" style="margin-left: -40px; width: 750px;">
				<div class="modal-header">
					<h4 class="modal-title">Edit</h4>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">×</span>
					</button>
				</div>
				<div class="modal-body">
					<form class="form-horizontal" role="form" id="fromAdd">
						<div class="row">
							<input type="hidden" name="idImage" id="idImage">
							
							<label class="col-md-2" >ACC
								MERCH </label>
							<div class="col-md-10" id="#select">
								<select required="required" class=" form-control idAccountAll " style="width: 100%;"
									tabindex="1" name="idAccount" data-class="">
									<option th:each="item:${lstacc}" th:text="${item.name} "
										th:value="${item.id}"></option>
								</select>
							</div>

							
					</form>

				</div>
				<div class="modal-footer justify-content-between">
					<button type="button" class="btn btn-default closetModal"
						data-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary saveAccountAll">Save
						changes</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>

	<!-- Bootstrap core JavaScript
    ================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->

	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
		integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
		crossorigin="anonymous"></script>
	<script
		src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
		integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
		crossorigin="anonymous"></script>
			<script
		src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js"></script>
		<script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.11.5/datatables.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tom-select@2.0.1/dist/js/tom-select.complete.min.js"></script>
<link
		href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.min.css"
		rel="stylesheet" />
	<script
		src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js"></script>
	
	<script type="text/javascript" th:inline="javascript">
	var base_url = [[@{/}]];
		function roundToTwo(num) {    
		    return +(Math.round(num + "e+2")  + "e-2");
		}
		function upload(){
			$('#formTable').submit();
		}
		
		 function deleteImage(){
				
		        	//$("#btn-submit-add").attr("disabled", true);
		        	var frm = $('#formTable');    
		        	console.log('asasas '+frm);
		        	$.ajax({
		        		type: frm.attr('method'),
		        		 url: base_url+'user/deleteimageupload',
		                data: frm.serialize(),
		                success: function (data) {
		                	  alert('Thanh cong');
		                	//$('#channelAdd').modal('hide');
		                	setTimeout(function(){
		                		location.reload();
		            		}, 1000);
		                },
		                error: function (data) {
		                	 alert('Loi');
		                }
		            });
		        
			}
		 
		$(document).ready(function() {
			/* new TomSelect(".ccySearch",{
				create: true,
				sortField: {
					field: "text",
					direction: "asc"
				}
			});
			 */
			 
			 
			
			/* new TomSelect(".ccy",{
				create: true,
				sortField: {
					field: "text",
					direction: "asc"
				}
			}); */
			 $('.ccy').select2();
			$('.ccySearch').select2();
			
			
			
			
		});
		
		
		
		 $('.checkAll').click(function() {
			 if ($('.checkAll').is(':checked')) {
				 
				 $("input[name='checkItem']").attr('checked',true);
			 }else{
				 $("input[name='checkItem']").attr('checked',false);
			 }
			 
			
			 
		 });
		 
		 $('.saveAccountAll').click(function() {
			 var yourArray=[];
			 $("input:checkbox[name=checkItem]:checked").each(function(){
				    yourArray.push($(this).val());
				});
			 var idAccount = $('.idAccountAll').val();
			
			 $.ajax({
	              url: base_url + 'user/updateImageAll',
	              data:{
	            	 
	            	  idAccount:idAccount,
	            	  checkItem:yourArray
	              },
	              async: false,
	              success: function(rs) {
	            	  if(rs=='00')
	            		  {
	            		  alert("Thành công!");
	            		  //$('#modal-default').modal('hide');
	            		  location.reload();
	            		  }else  if(rs=='02') {
	            			  alert("Loi");
	            		  }
	            		  else   {
	            			  alert("Loi");
	            		  }
	            	 
	              },
	              error: function (xhr, ajaxOptions, thrownError) {
	            	  alert("Lỗi!");
	            }
	          });
			 
		 });
		 
		 $('.saveAccount').click(function() {
			 var id = $('#idImage').val();
			 var idAccount = $('.ccy').val();
			 var title = $('.titleEdit').val();
			 var brand = $('.brandEdit').val();
			 var bullet1 = $('.bullet1Edit').val();
			 var bullet2 = $('.bullet2Edit').val();
			 
			 $.ajax({
	              url: base_url + 'user/updateImage',
	              data:{
	            	  id:id,
	            	  brand:brand,
	            	  bullet1:bullet1,
	            	  bullet2:bullet2,
	            	  title:title,
	            	  idAccount:idAccount
	              },
	              async: false,
	              success: function(rs) {
	            	  if(rs=='00')
	            		  {
	            		  alert("Thành công!");
	            		  //$('#modal-default').modal('hide');
	            		  location.reload();
	            		  }else  if(rs=='02') {
	            			  alert("Loi");
	            		  }
	            		  else   {
	            			  alert("Loi");
	            		  }
	            	 
	              },
	              error: function (xhr, ajaxOptions, thrownError) {
	            	  alert("Lỗi!");
	            }
	          });
			 
		 });
		 
		 
		 
		 $('.EditImageAll').click(function() {
				
			
			 $('#modal-UpdateAll').modal('show');
			 $('.idAccountAll').select2();
			 
		 });
		 
		 $('.EditImage').click(function() {
			
			 $('#idImage').val( $( this ).attr( "data-id" ));
			 $('.titleEdit').text( $( this ).attr( "data-title" ));
			 $('.brandEdit').text( $( this ).attr( "data-brand" ));
			 $('.bullet1Edit').text( $( this ).attr( "data-des1" ));
			 $('.bullet2Edit').text( $( this ).attr( "data-des2" ));
			 $(".ccy").val($( this ).attr( "data-idAccount" ));
			 $('#modal-default').modal('show');
			 
		 });
		 $(document).ready(function() {
			    $('#tableSale').dataTable({
			        'aLengthMenu':[25, 50, 75, 1000],
			        'iDisplayLength': 1000,
			        "scrollX": false,
			        "scrollY": "800px",
			        fixedHeader: true
			    });
			} );
		 $('.showDS').click(function() {
			 var id= $(this).parents('tr').find('.idSaleMerch').val();
			 console.log(id)
			 $.ajax({
	              url: base_url + 'user/showDS',
	              data:{id:id},
	              async: false,
	              success: function(rs) {
	            	  $('.channelEditBody').html(rs);
	              	//	  treeTable2(".tree-table");
	                  	  $('#channelEdit').modal('show');
	            	 
	              },
	              error: function (xhr, ajaxOptions, thrownError) {
	            	  alert("Lỗi!");
	            }
	          });
			 
		 });
		 $(function() {
		        var message = [[${message}]];
		        var message2 = message.message;
		        console.log(message);
		        if (message2 != null) {
		          alert(message2)
		        }
		      });
		 
		 
	</script>


</body>
</html>
