<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout">

<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">
<link rel="shortcut icon" type="image/x-icon" href="https://lh3.googleusercontent.com/fife/AAWUweVZg3sMC6axFZRXBvxTkrmlJ2zcZW0SMBRIZUpjd83Nqxh_67uKKpC3wO0Fjti6TnCc6ykMq3eZP2UlWn7Q8JjDE_bDm4_iP91Va90REd3Tc3v6OPt7ocbVeWxL7UeQip4gI7J60jvfhAmCpFw3JMEUHXFcSDBQcYDISxa_A2CeJ5bjDQZX04VibP-P6Mv1jzjhbpxDvgd4nu13Xw3BvA5PUPfDBWhLl0Pae_hToik4PpwtU5bTgoP9X6foF28YPZ-gr1SwZaLTJbv-DUkwBY1zYQDm78LgcHgUb58OMeJAKFxsqReCVhxzyqGctBgctjYxbkmyA04QKSxn18Ou_bYixc7qfrMvmO3v3kQvwbY-RvDaN2N4KVX2fcvq20WO65HYvNu2oMlpFBD_4hYkbuD1ORSffeJ1showhKMMCq6om9QdZSViNe_rRBgYI_Y4FeHjLG4nX_MHk_Xqlt5TcTMwtjxaoe0C33MGiFD8klzjiehyidsAMF_SXLY8VXNjhhEmWXFgRL56-krhtRQxP62G_c8XRqsk3kg0HKNaN9lAlJwurDVksJz_Sd7DUtBjY9ZM83lALAJXUHnRhU38cCUU8zLFwO9bePt0rzM-zbPpT-Epc-iQ8KxlrttRnfnDraGgOzY8TTJt8B_uZjeuoIR7WXmVgQwBstLoH5Ke1JfhyJQLmJgFYRPIpFzwahMdm7O0xvmPE6EyrdqlssYSdWB2jCsgEURT8zSWDesLLMq7ow-EN8jw9PHk3YGolS4rX3VXc6pRXf8-N4GImjvbJiXeVpOIvVAS0M-DxKrAlzAxKxqcGOwu8wrBFHCLX_YdzMEd7h-js1lyA5WWhUf_zP0IRwP4pNFoDZFrBqHIImsPEtBcE6gPhaUPBvS-sNLqvhv7qkY6ClbC5npcpIG_5peyX-GzWvP_xtZJwUClvY2xJHJ0FoB-X9AQ_AwnluZdTtALFltl=w1920-h937" />
<title>Merch Manager By Long Tran</title>
<script src="https://code.jquery.com/jquery-3.5.0.js"></script>
<link rel="canonical"
	href="https://getbootstrap.com/docs/4.0/examples/navbars/">

<!-- Bootstrap core CSS -->
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
	integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
	crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.css" />
<style>
.error {
	background-color: yellow;
}

.terminated {
	background-color: red;
	color: white;
}

.success {
	background: #28a745;
}

table.dataTable th {
	font-size: 0.7em;
}

table.dataTable td {
	font-size: 0.7em;
}
</style>	
</head>

<body>


	<div class="col-sm-10 col-md-10">
		<nav class="navbar navbar-expand-lg navbar-light"
			style="background-color: #e3f2fd;">
			<a class="navbar-brand" href="#">Navbar</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse"
				data-target="#navbarColor03" aria-controls="navbarColor03"
				aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarColor03">
				<ul class="navbar-nav mr-auto">
					<li class="nav-item active"><a class="nav-link"
						th:href="@{/user/allAcc}">All Account <span class="sr-only">(current)</span></a>
					</li>
					<li class="nav-item"><a class="nav-link"
						th:href="@{/user/checkSale}">Thống kê</a></li>
					<li class="nav-item"><a class="nav-link"
						th:href="@{/user/imageupload}">Quan Ly upload</a></li>
					<li class="nav-item"><a class="nav-link"
						th:href="@{/user/upload}">Upload</a></li>
					<li class="nav-item"><a class="nav-link"
						th:href="@{/admin/alluser}">Quản lý người dùng</a></li>
					<li class="nav-item"><a class="nav-link" href="#">About</a></li>
				</ul>
				<form class="form-inline">
					<input class="form-control mr-sm-2" type="search"
						placeholder="Search" aria-label="Search"> <a href="#"
						th:href="@{/logout}">Log Out</a>
				</form>
			</div>
		</nav>
	</div>


	<div class="row" style="padding-left: 15px;">


		<div class="col-sm-2">
			<section>
				<h3>
					<small>Quản lý account</small>
				</h3>

			</section>
		</div>


	</div>
	<div class="row" style="padding-left: 15px;">
		<div class="col-md-4"></div>
		<div class="col-md-2">
			<button type="button" class="btn btn-block btn-primary btn-sm "
				data-toggle="modal" data-target="#modal-default">Thêm mới
				acc</button>
		</div>

		<div class="col-md-4"></div>
		<div class="col-md-2">
			<button type="button"
				class="btn btn-block btn-primary btn-sm checkSaleAll ">
				Check all acc</button>
		</div>

	</div>
	<div class="form-control">

		<div class="col-md-12">
			<div class="card-body table-responsive p-0">
				<table class="table tableSale" style="overflow: hidden;" cellspacing="0" id="tableSale">
					<thead>
						<tr>
							<th>STT</th>
							<th>name</th>
							
							
							<th>ip</th>
							<th>path</th>
							<th>email</th>
							<th>checkSale</th>
							<th>check Product</th>
							<th>DELETE</th>
							<th>EDIT</th>
						</tr>
					</thead>
					<tbody>
						<th:block th:if="${lst != null}">
							<tr data-toggle="tooltip" th:each="item, k : ${lst}">

								<td th:text="${k.index + 1}" class="text-right"
									style="width: 5%;">1</td>
								<td th:text="${item.name}" class="text-left"></td>
								
								
								<td th:text="${item.ip}" class="text-left"></td>
								<td th:text="${item.path}" class="text-left"></td>
								<td th:text="${item.email}" class="text-left"></td>
								<td>
									<button type="button" th:attr="data-id=${item.id}"
										class="btn btn-block btn-primary btn-sm checkSaleButton">check
										sale</button>
								</td>
								<td>
									<button type="button" th:attr="data-id=${item.id}"
										class="btn btn-block btn-primary btn-sm checkProductButton">check
										Product</button>
								</td>
								<td>
									<button type="button" th:attr="data-id=${item.id},data-name=${item.id},data-name=${item.name},data-ip=${item.ip},data-path=${item.path},data-email=${item.email}"
										class="btn btn-block btn-primary btn-sm editButton">Edit</button>
								</td>
								<td>
									<button type="button" th:attr="data-id=${item.id}"
										class="btn btn-block btn-primary btn-sm deleteButton">DELETE</button>
								</td>

							</tr>
						</th:block>
					</tbody>
				</table>
			</div>

		</div>

	</div>

	<div class="modal fade" id="modal-default" style="display: none;"
		aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title">Thêm mới acc</h4>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">×</span>
					</button>
				</div>
				<div class="modal-body">
					<form class="form-horizontal" role="form" id="fromAdd">
						<div class="row">
							<label class="col-md-2">Name</label>
							<div class="col-md-10">
								<input class="form-control" name="name" type="text"
									required="required">
							</div>
							<label class="col-md-2">Email</label>
							<div class="col-md-10">
								<input class="form-control" type="text" name="email"
									required="required">
							</div>
							<label class="col-md-2">IP</label>
							<div class="col-md-10">
								<input class="form-control" type="text" name="ip"
									required="required">
							</div>
							<label class="col-md-2">PATH</label>
							<div class="col-md-10">
								<input class="form-control" type="text" name="path"
									required="required">
							</div>
						</div>
					</form>

				</div>
				<div class="modal-footer justify-content-between">
					<button type="button" class="btn btn-default closetModal"
						data-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary saveAccount">Save
						changes</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>
	
	
	<div class="modal fade" id="modal-default-edit" style="display: none;"
		aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title">Sửa Acc</h4>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">×</span>
					</button>
				</div>
				<div class="modal-body">
					<form class="form-horizontal" role="form" id="fromAdd">
						<div class="row">
						<input type="hidden" name="idImage" id="idImage">
							<label class="col-md-2">Name</label>
							<div class="col-md-10">
								<input class="form-control nameEdit" name="name" type="text"
									required="required">
							</div>
							<label class="col-md-2">Email</label>
							<div class="col-md-10">
								<input class="form-control emailEdit" type="text" name="email"
									required="required">
							</div>
							<label class="col-md-2">IP</label>
							<div class="col-md-10">
								<input class="form-control ipEdit" type="text" name="ip"
									required="required">
							</div>
							<label class="col-md-2">PATH</label>
							<div class="col-md-10">
								<input class="form-control pathEdit" type="text" name="path"
									required="required">
							</div>
						</div>
					</form>

				</div>
				<div class="modal-footer justify-content-between">
					<button type="button" class="btn btn-default closetModal"
						data-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary saveAccountEdit">Save
						changes</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>




	<!-- Bootstrap core JavaScript
    ================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->

	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
		integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
		crossorigin="anonymous"></script>
	
	<script
		src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
		integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
		crossorigin="anonymous"></script>
	<script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.js"></script>
		

	<script type="text/javascript" th:inline="javascript">
		var base_url = [[@{/}]];
		
		
			 $(document).ready(function() {
				    $('.tableSale').dataTable({
				        'aLengthMenu':[25, 50, 75, 1000],
				        'iDisplayLength': 1000,
				        "scrollX": false,
				        "scrollY": "800px",
				        fixedHeader: true
				    });
				} );
		 $('.deleteButton').click(function() {
			 var id = $(this).attr("data-id"); 
			 $.ajax({
	              url: base_url + 'user/deleteAccountMerch',
	              data:{id:id},
	              async: false,
	              success: function(rs) {
	            	  if(rs=='00')
	            		  {
	            		  setTimeout(function(){ alert("Thành công!"); }, 1500);
	            		  
	            		  
	            		  }else{
	            			  alert("Thất bại vui lòng kiểm tra !");
	            		  }
	            	 
	              },
	              error: function (xhr, ajaxOptions, thrownError) {
	            	  alert("Lỗi!");
	            }
	          });
			 
		 });
		 $('.saveAccountEdit').click(function() {
			 var id = $('#idImage').val();
			 var name = $('.nameEdit').val();
			 var email = $('.emailEdit').val();
			 var ip = $('.ipEdit').val();
			 var path = $('.pathEdit').val();
			 
			 $.ajax({
	              url: base_url + 'user/updateAccountMerch',
	              data:{
	            	  id:id,
	            	  name:name,
	            	  email:email,
	            	  ip:ip,
	            	  path:path
	              },
	              async: false,
	              success: function(rs) {
	            	  if(rs=='00')
	            		  {
	            		  alert("Thành công!");
	            		  //$('#modal-default').modal('hide');
	            		  //location.reload();
	            		  }else  if(rs=='02') {
	            			  alert("Loi");
	            		  }
	            		  else   {
	            			  alert("Loi");
	            		  }
	            	 
	              },
	              error: function (xhr, ajaxOptions, thrownError) {
	            	  alert("Lỗi!");
	            }
	          });
			 
		 });
		 $('.editButton').click(function() {
				
			 $('#idImage').val( $( this ).attr( "data-id" ));
			 $('.nameEdit').val( $( this ).attr( "data-name" ));
			 $('.emailEdit').val( $( this ).attr( "data-email" ));
			 $('.ipEdit').val( $( this ).attr( "data-ip" ));
			 $('.pathEdit').val( $( this ).attr( "data-path" ));
			 $('#modal-default-edit').modal('show');
			 
		 });
		 
		 
		 
		 
		 $('.checkProductButton').click(function() {
			 var id = $(this).attr("data-id");
			 $.ajax({
	              url: base_url + 'user/checkproduct',
	              data:{id:id},
	              async: false,
	              success: function(rs) {
	            	  if(rs=='00')
            		  {
            		  alert("Thành công!");
            		  }else  if(rs=='02') {
            			  alert("Kiểm tra tool vps chưa bật !");
            		  }
            		  else   {
            			  alert("Thất bại vui lòng kiểm tra !");
            		  }
	            	 
	              },
	              error: function (xhr, ajaxOptions, thrownError) {
	            	  alert("Lỗi!");
	            }
	          });
			 
		 });
		 
		 $('.checkSaleButton').click(function() {
			 var id = $(this).attr("data-id");
			 $.ajax({
	              url: base_url + 'user/checkSaleById',
	              data:{id:id},
	              async: false,
	              success: function(rs) {
	            	  if(rs=='00')
            		  {
            		  alert("Thành công!");
            		  }else  if(rs=='02') {
            			  alert("Kiểm tra tool vps chưa bật !");
            		  }
            		  else   {
            			  alert("Thất bại vui lòng kiểm tra !");
            		  }
	            	 
	              },
	              error: function (xhr, ajaxOptions, thrownError) {
	            	  alert("Lỗi!");
	            }
	          });
			 
		 });
		 
		 
		 
		 $('.checkSaleAll').click(function() {
			 var id = $(this).attr("data-id");
			 $.ajax({
	              url: base_url + 'user/checkSaleAllAcc',
	              data:{},
	              async: false,
	              success: function(rs) {
	            	  if(rs=='00')
            		  {
            		  alert("Thành công!");
            		  }else  if(rs=='02') {
            			  alert("Kiểm tra tool vps chưa bật !");
            		  }
            		  else   {
            			  alert("Thất bại vui lòng kiểm tra !");
            		  }
	            	 
	              },
	              error: function (xhr, ajaxOptions, thrownError) {
	            	  alert("Lỗi!");
	            }
	          });
			 
		 });
		 
		
		 $('.saveAccount').click(function() {
			 
			
		        var frm = $('#fromAdd'); 
			 $.ajax({
	              url: base_url + 'user/saveAccountMerch',
	              data: frm.serialize(),
	              async: false,
	              success: function(rs) {
	            	  if(rs=='00')
	            		  {
	            		  alert("Thành công!");
	            		  }else  if(rs=='02') {
	            			  alert("Kiểm tra tool vps chưa bật !");
	            		  }
	            		  else   {
	            			  alert("Thất bại vui lòng kiểm tra !");
	            		  }
	            	 
	              },
	              error: function (xhr, ajaxOptions, thrownError) {
	            	  alert("Lỗi!");
	            }
	          });
			 
		 });
		</script>
</body>
</html>
